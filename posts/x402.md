---

title: 'Research: x402, The Payment Protocol for Agentic Commerce'

date: '2025-12-17'

category: 'web3'

---


![image](https://raw.githubusercontent.com/tain030/blog-post/main/images/x402.svg)

### TL;DR

- **기계 간 결제를 위한 프로토콜:** x402는 AI 에이전트가 API 요청 단위로 비용을 자동 결제할 수 있도록 설계된 HTTP 기반 결제 표준이다. HTTP 402(“Payment Required”) 상태 코드를 활용해, 결제가 없는 요청에 대해 서버가 결제 정보를 반환하는 방식으로 동작한다.
    
- **블록체인 기반 정산:** 결제는 USDC 같은 스테이블코인을 사용해 온체인에서 처리되며, Base 같은 L2 환경에서는 수백 ms 수준으로 빠르게 확정된다. 이로 인해 차지백이 구조적으로 불가능하다.
    
- **마이크로페이먼트 현실화:** L2 롤업 덕분에 API 호출당 $0.001 수준의 초소액 과금이 가능해졌고, AI 추론·데이터 조회 같은 사용량 기반 과금 모델이 실질적으로 동작할 수 있게 된다.
    
- **단순한 요청 흐름:** 결제 없이 API를 호출하면 서버는 402 응답과 함께 가격 정보를 반환한다. 에이전트는 지갑 서명으로 결제를 승인해 동일 요청을 다시 보내고, 서버는 서명 검증 후 결제를 실행한다.
    
- **표준화된 메시지 구조:** 결제 요청은 `maxAmountRequired`, `assetAddress`, `payTo`, `network`, `expiresAt`, `nonce`, `paymentId` 등의 필드를 갖는 JSON으로 정의되며, 클라이언트는 이를 EIP-712 형식으로 서명한다.
    
- **체인·토큰 독립성:** 특정 체인이나 토큰에 종속되지 않도록 설계되었으며, 온체인 전송 외에도 L2, 배치 정산, 페이먼트 채널 등 다양한 정산 방식을 허용한다.
    
- **레거시 결제 마찰 제거:** 카드 결제에 수반되는 승인 지연, PCI 컴플라이언스, 차지백 리스크 없이 실시간 결제가 가능해 AI 에이전트 중심의 사용 시나리오에 적합하다.

---

x402 백서는 현재의 결제 시스템이 **사람 중심**으로 설계되어 있다는 점에서 출발한다. 신용카드, 구독, 인보이스 같은 기존 결제 방식은 승인에 시간이 걸리고 수수료가 높으며, 차지백이라는 구조적 리스크를 안고 있다. 이런 특성은 사람이 직접 결제하는 환경에서는 감내 가능했지만, **머신 대 머신 결제**나 **AI 에이전트의 자율적 행동**을 전제로 하면 큰 장애물이 된다.

예를 들어 AI 에이전트가 실시간 데이터 API를 호출하려 할 때, 사전 계정 생성이나 API 키 발급 같은 절차가 필요하다면 자동화는 사실상 불가능해진다. 이 때문에 백서는 “AI 에이전트는 필요할 때 즉시 자원을 구매할 수 있어야 한다”는 문제의식을 제기한다. x402의 목표는 이러한 마찰을 제거해, **완전히 자율적인 AI 시스템**이 경제 활동에 참여할 수 있도록 만드는 것이다. 백서에서는 이를 _머신 네이티브 결제(machine-native payments)_ 라고 표현하며, API 제공자와 AI 에이전트 사이에 신뢰 가능한 실시간 거래를 가능하게 하는 기반으로 x402를 제안한다.

## 개요

x402의 핵심 아이디어는 **HTTP 레벨에서 자동 결제를 표준화**하는 것이다. 이를 위해 기존에 거의 사용되지 않던 HTTP 402 상태 코드를 결제 트리거로 활용한다. 결제 정보 없이 API 요청이 들어오면, 서버는 402 응답과 함께 JSON 형식의 결제 요구사항을 반환한다.

이 JSON에는 요청당 비용, 사용할 토큰의 컨트랙트 주소, 수취 지갑 주소, 네트워크 정보 등이 포함된다. 클라이언트(AI 에이전트)는 이 정보를 바탕으로 자신의 암호화 지갑에서 **결제 승인 서명**을 생성하고, 이를 포함해 동일한 요청을 다시 전송한다. 서버는 서명을 검증한 뒤 실제 온체인 결제를 실행하고, 결제가 완료되면 원래의 API 응답을 반환한다.

이 구조 덕분에 x402는 API 키나 사용자 계정 없이도 요청 단위 과금을 가능하게 한다. 백서에서 제시한 예시처럼, 서버에 미들웨어 한 줄을 추가하는 것만으로 해당 엔드포인트를 유료 API로 만들 수 있다. 즉, x402는 **기존 HTTP 인프라 위에 블록체인 결제를 최소한의 변경으로 얹는 방식**을 택하고 있다.

## 기술 구조 및 모델

![image](https://raw.githubusercontent.com/tain030/blog-post/main/images/x402-1.png)

x402 프로토콜은 크게 세 부분으로 구성된다: **AI 에이전트(고객)**, **웹 서버(서비스 제공자)**, 그리고 **블록체인 네트워크**다. 구현 예시에서는 Node.js 기반 서버에 x402 미들웨어를 추가해 엔드포인트별 가격과 수취 지갑을 설정한다.

1. **클라이언트 요청:** AI 에이전트나 애플리케이션이 API 엔드포인트에 요청을 보낸다.
    
2. **서버의 402 응답:** 서버는 결제 정보가 없는 요청임을 확인하고, 402 상태 코드와 함께 결제 요구사항을 JSON으로 반환한다. 예를 들어, 
	```json
	{
	   "maxAmountRequired": "0.10",
	   "resource": "/api/market-data",
	   "description": "Access to data requires payment.",
	   "payTo": "0xABCDEF...1234",
	   "asset": "0xA0b8...6048",
	   "network": "ethereum-mainnet"
	}
	```
	이 JSON에는 결제 금액, 자산, 네트워크 등 필요한 정보가 명확히 포함된다.
    
3. **결제 서명 생성:** 에이전트는 이 정보를 검토한 뒤, 지갑을 사용해 EIP-712 형식의 서명을 생성한다. 여기서 EIP-712 형식의 서명은 응답의 모든 필드, 실제 결제 금액(≤ `maxAmountRequired`), 그리고 현재 타임스탬프 등을 포함한다. 이를 통해 “이 요청에 대해 이 금액을 지불한다”는 의사를 암호학적으로 명시하게 된다.
    
4. **재요청 및 검증:** 에이전트는 서명을 포함해 동일한 API 요청을 다시 전송한다. 서버의 x402 미들웨어는 서명의 유효성을 검증하고, 아직 유효 기간(`expiresAt`)이 남아있는지, 서명된 금액이 최대치를 넘지 않는지 확인한다.
    
5. **블록체인 전송:** 검증이 완료되면 서버(또는 x402 facilitator)가 트랜잭션을 전송한다. (facilitator, bazaar와 같은 구현상 필요한 요소들은 다음 포스트에서 자세히 다룬다.)
    
6. **결과 반환:** 토큰 전송 트랜잭션이 확정되면, 서버는 클라이언트에게 API 요청 결과를 반환한다.

x402는 온체인 전송뿐 아니라 L2 롤업, 배치 정산, 페이먼트 채널 등 다양한 정산 방식을 허용하도록 설계되어 있다. 이를 통해 요청 빈도나 규모에 따라 비용 효율적인 방식을 선택할 수 있다. 전반적으로 아키텍처의 목표는 **기존 웹 API 구조를 최대한 유지하면서 결제만 덧붙이는 것**이다.

## 핵심 메커니즘

x402의 중심에는 HTTP 402 응답을 통한 결제 요청 메커니즘이 있다. 결제가 필요한 API에 접근하면 서버는 결제 인보이스 역할을 하는 JSON을 반환하고, 에이전트는 이를 자동으로 해석해 결제 절차를 수행한다.

결제 요청 JSON에는 `maxAmountRequired`, `assetAddress`, `payTo`, `network`, `expiresAt`, `nonce`, `paymentId` 같은 필드가 포함된다. 이 필드들은 결제 조건을 명확히 제한해 과금 범위를 벗어나는 사용을 방지한다. 특히 `nonce`와 `paymentId`는 동일한 결제 요청이 재사용되는 것을 막아 보안성을 높인다.

에이전트는 이 결제 요청을 EIP-712 구조화 서명으로 승인한다. 이 방식은 서명 대상 메시지를 사람이 읽을 수 있는 형태로 표현해, 지갑 수준에서 “무엇에 대한 결제인지”를 명확히 한다. 서버는 이 서명을 검증함으로써 실제 지갑 소유자가 해당 요청에 대해 결제를 승인했음을 확인한다.

정산은 상황에 따라 여러 방식으로 이뤄질 수 있다. 기본적으로는 온체인 토큰 전송이 사용되지만, 비용과 속도를 고려해 L2 롤업이나 배치 전송을 선택할 수도 있다. 이 유연성 덕분에 고빈도의 초소액 결제도 현실적으로 처리할 수 있다.

개발자 입장에서는 통합도 단순하다. 예를 들어 아래와 같은 미들웨어를 추가하면 해당 엔드포인트는 유료 API가 된다.

```js
app.get('/premium', x402PaymentRequired({
	amount: "0.10",
	address: "0x1234...",
	assetAddress: "0x2345...", // USDC 컨트랙트
	network: "base-mainnet"
}), (req, res) => {
	res.json({ data: "Premium content" });
});
```

## 보안성과 정확성에 대한 보장

x402의 보안 모델은 블록체인의 특성에 크게 의존한다. 결제는 온체인에서 이루어지므로, 한 번 확정되면 되돌릴 수 없다. 백서에서도 이러한 **즉시 확정성과 차지백 불가능성**을 핵심 장점으로 강조한다.

모든 결제 승인은 EIP-712 서명을 통해 이뤄진다. 서명에는 금액과 요청 파라미터가 명시적으로 포함되기 때문에, 에이전트가 승인하지 않은 과금은 성립할 수 없다. 개인키 없이는 서명을 생성할 수 없으므로, 유효한 서명은 지갑 소유자의 명시적 동의를 의미한다.

또한 `nonce`, `paymentId`, `expiresAt` 같은 필드로 결제 요청의 재사용이나 재생 공격을 방지한다. 다만 이러한 보안 보장은 전적으로 사용되는 블록체인과 지갑 인프라의 안전성에 의존한다는 점은 전제 조건으로 남는다.

## 기존 기술과의 비교

![image](https://raw.githubusercontent.com/tain030/blog-post/main/images/x402-2.png)

x402는 신용카드나 페이팔 같은 기존 결제 시스템과 비교했을 때, 수수료·지연·차지백이라는 세 가지 문제를 동시에 제거한다. 카드 결제는 처리 지연과 취소 리스크가 존재하지만, x402는 거의 즉시 확정된다.

암호화폐 결제와 비교해도 차이가 있다. 이더리움 메인넷은 수수료와 확정 시간이 길어 마이크로페이먼트에 적합하지 않지만, x402는 L2 환경을 전제로 해 비용과 지연을 크게 줄였다. 결과적으로 고빈도 API 호출에 더 적합한 구조를 갖는다.

무엇보다 중요한 차별점은 **결제 흐름이 HTTP 자체에 통합되어 있다는 점**이다. 이는 기존 결제 API나 인증 표준과는 다른 계층의 접근 방식이다.

## 한계점 및 향후 과제

백서는 제한 사항을 상세히 나열하지는 않지만, 몇 가지 전제와 과제가 암묵적으로 존재한다. 에이전트가 지갑과 스테이블코인을 보유해야 하며, 온보딩 과정에 대한 설명은 부족하다. 또한 규제, 회계 처리, 키 관리 같은 운영상의 문제는 다뤄지지 않는다.

블록체인과 스테이블코인의 안정성에 대한 가정 역시 중요한 전제다. 이러한 요소가 흔들릴 경우 x402의 실효성도 영향을 받을 수 있다.

x402가 도입되면 가장 큰 변화는 **사용량 기반 마이크로페이먼트의 활성화**다. API 호출, AI 추론, 데이터 조회 같은 행위가 모두 즉시 결제와 연결될 수 있다. 이는 기존 구독 모델로는 구현하기 어려웠던 새로운 비즈니스 모델을 가능하게 한다.

또한 결제와 청구 로직이 단순해져 서비스 운영 비용이 줄어들고, 글로벌 접근성도 향상된다. 백서가 강조하듯, 이는 궁극적으로 **AI 에이전트 중심의 상거래 생태계**를 촉진하는 기반이 된다.

## 요약

x402는 AI 에이전트와 웹 서비스가 온체인 화폐로 자동 결제할 수 있도록 설계된 HTTP 기반 결제 프로토콜이다. HTTP 402 상태 코드와 표준화된 JSON, EIP-712 서명을 결합해 요청 단위 결제를 구현한다. 이 접근은 기존 결제 시스템의 마찰을 제거하고, 초소액·실시간 결제를 가능하게 한다. 결과적으로 x402는 AI 주도의 디지털 경제를 위한 새로운 결제 표준으로 자리매김할 것으로 기대된다.
